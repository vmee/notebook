# 文件查找

在文件系统上查找符合条件的文件

实现工具 locate，find

## locate命令

依赖于事先构建好的索引库
- 系统自动实现（周期性任务）
- 手动更新数据库（updatedb）较占资源

工作特性
- 查找速度快
- 模糊查找
- 非实时查找

格式：locate option PATTERN
- -b 只匹配路径中的基名
- -c 统计出有多少个符合条件的文件
- -r BRE

> 索引构建过程需要遍历整个根文件系统，较耗资源


## find命令

实时查找工作，通过遍历指定起始路径下文件系统层级结构

工作特性：
- 查找速度略慢
- 精确查找
- 实时查找

用法：find [options] [查找起始路径] [查找条件] [处理动作]

- 查找起始路径 指定具体搜索的目录，默认为当前目录 
- 查找条件 指定的查找标准，可以根据文件名、大小、类型、从属关系等标准进行，默认找出指定路径下的所有文件
- 处理动作： 对符合查找条件的文件做出的动作，例如删除等操作，默认为输出至标准输出

查找条件
表达式： 选项和测试 

测试：结果通常为布尔型（true,false）
- 根据文件名查找
  - -name "PATTERN"
  - -iname "PATTERN" 忽略大小写 
    - 支持glob通配符： *、？、[]、[^]
  - regex pattern : 基于正则表达式模式查找文件，匹配是整个路径 ，而非基名
- 根据文件从属关系查找
  - -user USERNAME： 查找属主指定用户的所有文件
  - -group GRPNAME 查找属组指定组的所有文件
  - -uid UID 查找属主指定的UID的所有文件
  - -gid UID 查找属组指定的GID的所有文件
  - -nouser: 查找没有属主的文件
  - -nogroup 查找没有属组的文件
- 根据文件的类型查找
  - -type TYPE
    - f:普通文件
    - d 目录文件
    - l 符号链接文件
    - b 块设备文件
    - c 字符设备文件
    - p 管道文件
    - s 套接字文件
- 组合测试：
  - 与 -a  默认组合操作
  - 或 -o   
  - 非 -not，！
- 根据文件大小来找
  - 常用单位 G,M,K
  - -size
  - #unit {#-1, #}
  - -#unit {0, #-1}
  - +#unit {#, oo}
- 根据时间戳查找
  - 以天为单位
    - -atime [+|-]#
      - #{#, #-1}
      - +#{oo, #-1}
      - -#{#, 0}
    - mtime
    - ctime
  - 以分钟为单位
    - amin
    - mmin
    - cmin
-根据权限查找
    -  -perm [/|-]mode
       -  mode 精确仅限匹配
       -  /mode 任何一类用户（u、g、o）的权限中的任何一类用户任何一位权限满足权限即满足
          -  9位权限之间存在或关系
       -  -mode 每一类用户 （u、g、o）中的每一位（rwx）同时满足条件即满足
          -  9位权限之间存在与关系
- 处理动作
  - -print 输出至标准输出，默认动作
  - -ls 类似于对查找到的文件执行"ls -l"命令 输出文件的详细结果
  - -delete 删除查找到的文件
  - -fls /path/to/somefile 把查找到的所有文件的长格式信息保存到指定文件中
  - -ok COMMMAND {} \; : 对查找到的每个文件执行由CMMAND表示的命令，每次操作都由用户确认完成
  - -exec COMMMAND {} \; : 对查找到的每个文件执行由CMMAND表示的命令，无需确认

> 注意： find传递查找到的文件路径至后面的命令时，是先查找出所有符合条件的文件路径 ，并一次传递给后面的命令
> 但是有些命令不能接受过长的参数，此时命令执行会失败; 另一种试可规避此问题：
> find | xargs COMMAND


